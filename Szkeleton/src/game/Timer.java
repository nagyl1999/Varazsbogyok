package game;

import graphics.VarazsbogyokFrame;
import inventory.IStorable;

import java.io.Serializable;

/*

  Generated by StarUML(tm) Java Add-In

  @ Project : Varazsbogyok
  @ File Name : game.Timer.java
  @ Date : 2022. 03. 23.
  @ Author : varazsbogyok

*/

import java.util.ArrayList;

/**
 * Időzítő osztály, a léptethető dolgok léptetéséért felel
 */
public class Timer implements Serializable {
	private static Timer timer = null;
    /**
     * Léptethető objektumok listája
     */
    public static ArrayList<Steppable> steppables;
    /**
     *
     */
    private static Steppable active;

    /**
     * Konstruktor
     */
    private Timer() {
        steppables  = new ArrayList<Steppable>();
        active = null;
    }
    
    public static Timer getInstance() {
    	if(timer == null)
            timer = new Timer();
    	return timer;
    }

    /**
     * A léptethető objektumokon egyszer
     * meghívjuk a lépést
     */
    public void tick() {
        int index = steppables.indexOf(active); // -1 if null
        if (index + 1 == steppables.size())
            index = -1;
        active = steppables.get(++index);
        try {
            active.step();
        } catch (Exception ignore) {
            ignore.printStackTrace();
            System.out.println("Error in steppable");
        } finally {
            VarazsbogyokFrame.getInstance().redraw();
        }
    }

    /**
     * Léptethető objektum hozzáadása
     */
    public void addSteppable(Steppable s) {
        steppables.add(s);
    }

    /**
     * Léptethető objektum törlése
     */
    public void removeSteppable(Steppable s) {
        steppables.remove(s);
    }
}
